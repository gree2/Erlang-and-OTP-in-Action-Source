<html>
<head><title>/Users/martinjlogan/book_workspace/code/chapter_11/_build/development/docs/coverage/simple_cache/simple_cache.html</title></head><body bgcolor=white text=black>
<pre>
File generated from /Users/martinjlogan/book_workspace/code/chapter_11/_build/development/apps/simple_cache-0.1.0.3/ebin/../src/simple_cache.erl by COVER 2010-04-13 at 16:47:42

****************************************************************************

        |  %%%-------------------------------------------------------------------
        |  %%% @author Martin Logan &lt;martinjlogan@Macintosh.local&gt;
        |  %%% @copyright (C) 2009, Martin Logan
        |  %%% @doc
        |  %%%  The main programmers API to the simple cache.
        |  %%% @end
        |  %%% Created : 11 Jan 2009 by Martin Logan &lt;martinjlogan@Macintosh.local&gt;
        |  %%%-------------------------------------------------------------------
        |  -module(simple_cache).
        |  
        |  %% API
        |  -export([
        |  	 insert/2,
        |  	 delete/1,
        |  	 lookup/1
        |  	]).
        |  
        |  %%%===================================================================
        |  %%% API
        |  %%%===================================================================
        |  
        |  %%--------------------------------------------------------------------
        |  %% @doc insert an element into the cache.
        |  %% @spec insert(Key, Value) -&gt; ok
        |  %% where
        |  %%  Key = term()
        |  %%  Value = term()
        |  %% @end
        |  %%--------------------------------------------------------------------
        |  insert(Key, Value) -&gt;
<font color=red>     0..|      case sc_store:lookup(Key) of</font>
        |  	{ok, Pid} -&gt;
<font color=red>     0..|  	    sc_event:replace(Key, Value),</font>
<font color=red>     0..|  	    sc_element:replace(Pid, Value);</font>
        |  	{error, _Reason} -&gt;
<font color=red>     0..|  	    {ok, Pid} = sc_element:create(Value),</font>
<font color=red>     0..|  	    sc_store:insert(Key, Pid),</font>
<font color=red>     0..|  	    sc_event:create(Key, Value)</font>
        |      end.
        |  
        |  %%--------------------------------------------------------------------
        |  %% @doc lookup an element in the cache.
        |  %% @spec lookup(Key) -&gt; {ok, Value} | {error, not_found}
        |  %% where
        |  %%  Key = term()
        |  %%  Value = term()
        |  %% @end
        |  %%--------------------------------------------------------------------
        |  lookup(Key) -&gt;
<font color=red>     0..|      sc_event:lookup(Key),</font>
<font color=red>     0..|      try</font>
<font color=red>     0..|  	{ok, Pid} = sc_store:lookup(Key),</font>
<font color=red>     0..|  	{ok, Value} = sc_element:fetch(Pid),</font>
<font color=red>     0..|  	{ok, Value}</font>
        |      catch
        |  	_Class:_Exception -&gt;
<font color=red>     0..|  	    {error, not_found}</font>
        |      end.
        |  
        |  
        |  %%--------------------------------------------------------------------
        |  %% @doc delete an element into the cache.
        |  %% @spec delete(Key) -&gt; ok
        |  %% where
        |  %%  Key = term()
        |  %% @end
        |  %%--------------------------------------------------------------------
        |  delete(Key) -&gt;
<font color=red>     0..|      sc_event:delete(Key),</font>
<font color=red>     0..|      case sc_store:lookup(Key) of</font>
        |  	{ok, Pid} -&gt;
<font color=red>     0..|  	    sc_element:delete(Pid);</font>
        |  	{error, _Reason} -&gt;
<font color=red>     0..|  	    ok</font>
        |      end.
</pre>
</body>
</html>
